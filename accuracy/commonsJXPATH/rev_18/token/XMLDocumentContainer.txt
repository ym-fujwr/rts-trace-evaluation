package
org
.
apache
.
commons
.
jxpath
;
import
java
.
net
.
URL
;
import
javax
.
xml
.
transform
.
Source
;
import
javax
.
xml
.
transform
.
Transformer
;
import
javax
.
xml
.
transform
.
TransformerFactory
;
import
javax
.
xml
.
transform
.
dom
.
DOMResult
;
import
org
.
apache
.
commons
.
jxpath
.
xml
.
DocumentContainer
;
public
class
XMLDocumentContainer
implements
Container
{
private
DocumentContainer
delegate
;
private
Object
document
;
private
URL
xmlURL
;
private
Source
source
;
public
XMLDocumentContainer
(
URL
xmlURL
)
{
this
.
xmlURL
=
xmlURL
;
delegate
=
new
DocumentContainer
(
xmlURL
)
;
}
public
XMLDocumentContainer
(
Source
source
)
{
this
.
source
=
source
;
if
(
source
==
null
)
{
throw
new
RuntimeException
(
"Source is null"
)
;
}
}
public
Object
getValue
(
)
{
if
(
document
==
null
)
{
try
{
if
(
source
!=
null
)
{
DOMResult
result
=
new
DOMResult
(
)
;
Transformer
trans
=
TransformerFactory
.
newInstance
(
)
.
newTransformer
(
)
;
trans
.
transform
(
source
,
result
)
;
document
=
result
.
getNode
(
)
;
}
else
{
document
=
delegate
.
getValue
(
)
;
}
}
catch
(
Exception
ex
)
{
throw
new
JXPathException
(
"Cannot read XML from: "
+
(
xmlURL
!=
null
?
xmlURL
.
toString
(
)
:
(
source
!=
null
?
source
.
getSystemId
(
)
:
"<<undefined source>>"
)
)
,
ex
)
;
}
}
return
document
;
}
public
void
setValue
(
Object
value
)
{
throw
new
UnsupportedOperationException
(
)
;
}
}
<EOF>
