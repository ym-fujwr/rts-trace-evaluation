package
org
.
apache
.
commons
.
net
.
examples
.
unix
;
import
java
.
io
.
IOException
;
import
org
.
apache
.
commons
.
net
.
bsd
.
RCommandClient
;
import
org
.
apache
.
commons
.
net
.
examples
.
util
.
IOUtil
;
public
final
class
rshell
{
public
static
void
main
(
final
String
[
]
args
)
{
final
String
server
;
final
String
localuser
;
final
String
remoteuser
;
final
String
command
;
final
RCommandClient
client
;
if
(
args
.
length
!=
4
)
{
System
.
err
.
println
(
"Usage: rshell <hostname> <localuser> <remoteuser> <command>"
)
;
System
.
exit
(
1
)
;
return
;
}
client
=
new
RCommandClient
(
)
;
server
=
args
[
0
]
;
localuser
=
args
[
1
]
;
remoteuser
=
args
[
2
]
;
command
=
args
[
3
]
;
try
{
client
.
connect
(
server
)
;
}
catch
(
final
IOException
e
)
{
System
.
err
.
println
(
"Could not connect to server."
)
;
e
.
printStackTrace
(
)
;
System
.
exit
(
1
)
;
}
try
{
client
.
rcommand
(
localuser
,
remoteuser
,
command
)
;
}
catch
(
final
IOException
e
)
{
try
{
client
.
disconnect
(
)
;
}
catch
(
final
IOException
f
)
{
}
e
.
printStackTrace
(
)
;
System
.
err
.
println
(
"Could not execute command."
)
;
System
.
exit
(
1
)
;
}
IOUtil
.
readWrite
(
client
.
getInputStream
(
)
,
client
.
getOutputStream
(
)
,
System
.
in
,
System
.
out
)
;
try
{
client
.
disconnect
(
)
;
}
catch
(
final
IOException
e
)
{
e
.
printStackTrace
(
)
;
System
.
exit
(
1
)
;
}
System
.
exit
(
0
)
;
}
}
<EOF>
