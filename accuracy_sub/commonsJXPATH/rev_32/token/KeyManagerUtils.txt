package
org
.
apache
.
commons
.
jxpath
.
util
;
import
org
.
apache
.
commons
.
jxpath
.
BasicNodeSet
;
import
org
.
apache
.
commons
.
jxpath
.
ExtendedKeyManager
;
import
org
.
apache
.
commons
.
jxpath
.
JXPathContext
;
import
org
.
apache
.
commons
.
jxpath
.
KeyManager
;
import
org
.
apache
.
commons
.
jxpath
.
NodeSet
;
import
org
.
apache
.
commons
.
jxpath
.
Pointer
;
import
org
.
apache
.
commons
.
jxpath
.
ri
.
InfoSetUtil
;
public
class
KeyManagerUtils
{
private
static
class
SingleNodeExtendedKeyManager
implements
ExtendedKeyManager
{
private
final
KeyManager
delegate
;
public
SingleNodeExtendedKeyManager
(
final
KeyManager
delegate
)
{
this
.
delegate
=
delegate
;
}
@
Override
public
NodeSet
getNodeSetByKey
(
final
JXPathContext
context
,
final
String
key
,
final
Object
value
)
{
final
Pointer
pointer
=
delegate
.
getPointerByKey
(
context
,
key
,
InfoSetUtil
.
stringValue
(
value
)
)
;
final
BasicNodeSet
result
=
new
BasicNodeSet
(
)
;
result
.
add
(
pointer
)
;
return
result
;
}
@
Override
public
Pointer
getPointerByKey
(
final
JXPathContext
context
,
final
String
keyName
,
final
String
keyValue
)
{
return
delegate
.
getPointerByKey
(
context
,
keyName
,
keyValue
)
;
}
}
public
static
ExtendedKeyManager
getExtendedKeyManager
(
final
KeyManager
keyManager
)
{
return
keyManager
instanceof
ExtendedKeyManager
?
(
ExtendedKeyManager
)
keyManager
:
new
SingleNodeExtendedKeyManager
(
keyManager
)
;
}
}
<EOF>
