package
org
.
apache
.
commons
.
jxpath
.
ri
.
model
.
dynamic
;
import
java
.
util
.
Locale
;
import
org
.
apache
.
commons
.
jxpath
.
DynamicPropertyHandler
;
import
org
.
apache
.
commons
.
jxpath
.
JXPathBeanInfo
;
import
org
.
apache
.
commons
.
jxpath
.
JXPathIntrospector
;
import
org
.
apache
.
commons
.
jxpath
.
ri
.
QName
;
import
org
.
apache
.
commons
.
jxpath
.
ri
.
model
.
NodePointer
;
import
org
.
apache
.
commons
.
jxpath
.
ri
.
model
.
NodePointerFactory
;
import
org
.
apache
.
commons
.
jxpath
.
ri
.
model
.
beans
.
NullPointer
;
import
org
.
apache
.
commons
.
jxpath
.
util
.
ValueUtils
;
public
class
DynamicPointerFactory
implements
NodePointerFactory
{
public
static
final
int
DYNAMIC_POINTER_FACTORY_ORDER
=
800
;
@
Override
public
int
getOrder
(
)
{
return
DYNAMIC_POINTER_FACTORY_ORDER
;
}
@
Override
public
NodePointer
createNodePointer
(
final
QName
name
,
final
Object
bean
,
final
Locale
locale
)
{
final
JXPathBeanInfo
bi
=
JXPathIntrospector
.
getBeanInfo
(
bean
.
getClass
(
)
)
;
if
(
bi
.
isDynamic
(
)
)
{
final
DynamicPropertyHandler
handler
=
ValueUtils
.
getDynamicPropertyHandler
(
bi
.
getDynamicPropertyHandlerClass
(
)
)
;
return
new
DynamicPointer
(
name
,
bean
,
handler
,
locale
)
;
}
return
null
;
}
@
Override
public
NodePointer
createNodePointer
(
final
NodePointer
parent
,
final
QName
name
,
final
Object
bean
)
{
if
(
bean
==
null
)
{
return
new
NullPointer
(
parent
,
name
)
;
}
final
JXPathBeanInfo
bi
=
JXPathIntrospector
.
getBeanInfo
(
bean
.
getClass
(
)
)
;
if
(
bi
.
isDynamic
(
)
)
{
final
DynamicPropertyHandler
handler
=
ValueUtils
.
getDynamicPropertyHandler
(
bi
.
getDynamicPropertyHandlerClass
(
)
)
;
return
new
DynamicPointer
(
parent
,
name
,
bean
,
handler
)
;
}
return
null
;
}
}
<EOF>
