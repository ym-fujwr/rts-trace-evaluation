package
org
.
apache
.
commons
.
jxpath
.
servlet
;
import
java
.
util
.
Enumeration
;
import
java
.
util
.
HashSet
;
import
javax
.
servlet
.
ServletRequest
;
public
class
ServletRequestHandler
extends
HttpSessionHandler
{
protected
void
collectPropertyNames
(
HashSet
set
,
Object
bean
)
{
super
.
collectPropertyNames
(
set
,
bean
)
;
ServletRequestAndContext
handle
=
(
ServletRequestAndContext
)
bean
;
ServletRequest
servletRequest
=
handle
.
getServletRequest
(
)
;
Enumeration
e
=
servletRequest
.
getAttributeNames
(
)
;
while
(
e
.
hasMoreElements
(
)
)
{
set
.
add
(
e
.
nextElement
(
)
)
;
}
e
=
servletRequest
.
getParameterNames
(
)
;
while
(
e
.
hasMoreElements
(
)
)
{
set
.
add
(
e
.
nextElement
(
)
)
;
}
}
public
Object
getProperty
(
Object
bean
,
String
property
)
{
ServletRequestAndContext
handle
=
(
ServletRequestAndContext
)
bean
;
ServletRequest
servletRequest
=
handle
.
getServletRequest
(
)
;
String
[
]
strings
=
servletRequest
.
getParameterValues
(
property
)
;
if
(
strings
!=
null
)
{
if
(
strings
.
length
==
0
)
{
return
null
;
}
if
(
strings
.
length
==
1
)
{
return
strings
[
0
]
;
}
return
strings
;
}
Object
object
=
servletRequest
.
getAttribute
(
property
)
;
if
(
object
!=
null
)
{
return
object
;
}
return
super
.
getProperty
(
bean
,
property
)
;
}
public
void
setProperty
(
Object
request
,
String
property
,
Object
value
)
{
(
(
ServletRequestAndContext
)
request
)
.
getServletRequest
(
)
.
setAttribute
(
property
,
value
)
;
}
}
<EOF>
