package
org
.
apache
.
commons
.
jxpath
.
ri
.
compiler
;
import
org
.
apache
.
commons
.
jxpath
.
ri
.
EvalContext
;
import
org
.
apache
.
commons
.
jxpath
.
ri
.
axes
.
InitialContext
;
public
class
LocationPath
extends
Path
{
private
final
boolean
absolute
;
public
LocationPath
(
final
boolean
absolute
,
final
Step
[
]
steps
)
{
super
(
steps
)
;
this
.
absolute
=
absolute
;
}
public
boolean
isAbsolute
(
)
{
return
absolute
;
}
@
Override
public
boolean
computeContextDependent
(
)
{
return
!
absolute
||
super
.
computeContextDependent
(
)
;
}
@
Override
public
String
toString
(
)
{
final
StringBuilder
buffer
=
new
StringBuilder
(
)
;
final
Step
[
]
steps
=
getSteps
(
)
;
if
(
steps
!=
null
)
{
for
(
int
i
=
0
;
i
<
steps
.
length
;
i
++
)
{
if
(
i
>
0
||
absolute
)
{
buffer
.
append
(
'/'
)
;
}
buffer
.
append
(
steps
[
i
]
)
;
}
}
return
buffer
.
toString
(
)
;
}
@
Override
public
Object
compute
(
final
EvalContext
context
)
{
EvalContext
rootContext
;
if
(
isAbsolute
(
)
)
{
rootContext
=
context
.
getRootContext
(
)
.
getAbsoluteRootContext
(
)
;
}
else
{
rootContext
=
new
InitialContext
(
context
)
;
}
return
evalSteps
(
rootContext
)
;
}
@
Override
public
Object
computeValue
(
final
EvalContext
context
)
{
EvalContext
rootContext
;
if
(
isAbsolute
(
)
)
{
rootContext
=
context
.
getRootContext
(
)
.
getAbsoluteRootContext
(
)
;
}
else
{
rootContext
=
new
InitialContext
(
context
)
;
}
return
getSingleNodePointerForSteps
(
rootContext
)
;
}
}
<EOF>
