diff --git a/src/main/java/org/apache/commons/net/bsd/RCommandClient.java b/src/main/java/org/apache/commons/net/bsd/RCommandClient.java
index dcb5a370a..909d9ce93 100644
--- a/src/main/java/org/apache/commons/net/bsd/RCommandClient.java
+++ b/src/main/java/org/apache/commons/net/bsd/RCommandClient.java
@@ -221,0 +222 @@ public class RCommandClient extends RExecClient {
+        ServerSocket server;
@@ -225 +226 @@ public class RCommandClient extends RExecClient {
-        ServerSocket server = null;
+        server = null;
diff --git a/src/main/java/org/apache/commons/net/bsd/RExecClient.java b/src/main/java/org/apache/commons/net/bsd/RExecClient.java
index bce823c87..1c8ce9309 100644
--- a/src/main/java/org/apache/commons/net/bsd/RExecClient.java
+++ b/src/main/java/org/apache/commons/net/bsd/RExecClient.java
@@ -81,0 +82 @@ public class RExecClient extends SocketClient {
+        final ServerSocket server;
@@ -84,6 +85,8 @@ public class RExecClient extends SocketClient {
-        try (final ServerSocket server = _serverSocketFactory_.createServerSocket(0, 1, getLocalAddress())) {
-            _output_.write(Integer.toString(server.getLocalPort()).getBytes(StandardCharsets.UTF_8)); // $NON-NLS-1$
-            _output_.write(NULL_CHAR);
-            _output_.flush();
-            socket = server.accept();
-        }
+        server = _serverSocketFactory_.createServerSocket(0, 1, getLocalAddress());
+
+        _output_.write(Integer.toString(server.getLocalPort()).getBytes(StandardCharsets.UTF_8)); // $NON-NLS-1$
+        _output_.write(NULL_CHAR);
+        _output_.flush();
+
+        socket = server.accept();
+        server.close();
diff --git a/src/main/java/org/apache/commons/net/io/SocketInputStream.java b/src/main/java/org/apache/commons/net/io/SocketInputStream.java
index f38c33215..f21eb40d8 100644
--- a/src/main/java/org/apache/commons/net/io/SocketInputStream.java
+++ b/src/main/java/org/apache/commons/net/io/SocketInputStream.java
@@ -29,0 +30 @@ import java.net.Socket;
+ *
@@ -31,0 +33 @@ import java.net.Socket;
+
