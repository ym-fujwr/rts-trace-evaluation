package
org
.
apache
.
commons
.
net
.
examples
.
mail
;
import
java
.
io
.
IOException
;
import
java
.
net
.
URI
;
import
org
.
apache
.
commons
.
net
.
PrintCommandListener
;
import
org
.
apache
.
commons
.
net
.
imap
.
IMAPClient
;
public
final
class
IMAPMail
{
public
static
void
main
(
final
String
[
]
args
)
throws
IOException
{
if
(
args
.
length
!=
1
)
{
System
.
err
.
println
(
"Usage: IMAPMail imap[s]://username:password@server/"
)
;
System
.
err
.
println
(
"Connects to server; lists capabilities and shows Inbox status"
)
;
System
.
exit
(
1
)
;
}
final
URI
uri
=
URI
.
create
(
args
[
0
]
)
;
final
IMAPClient
imap
=
IMAPUtils
.
imapLogin
(
uri
,
10000
,
null
)
;
imap
.
addProtocolCommandListener
(
new
PrintCommandListener
(
System
.
out
,
true
)
)
;
try
{
imap
.
setSoTimeout
(
6000
)
;
imap
.
capability
(
)
;
imap
.
select
(
"inbox"
)
;
imap
.
examine
(
"inbox"
)
;
imap
.
status
(
"inbox"
,
new
String
[
]
{
"MESSAGES"
}
)
;
imap
.
list
(
""
,
"*"
)
;
}
catch
(
final
IOException
e
)
{
System
.
out
.
println
(
imap
.
getReplyString
(
)
)
;
e
.
printStackTrace
(
)
;
System
.
exit
(
10
)
;
return
;
}
finally
{
imap
.
logout
(
)
;
imap
.
disconnect
(
)
;
}
}
}
<EOF>
